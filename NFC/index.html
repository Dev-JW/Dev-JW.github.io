<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.82.0"><meta name=theme-color content="#fff"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>iOS14下的NFC技术实践 | Dev - jw</title><link rel=stylesheet href=../css/meme.min.ae509b8259cb6c090411be6371211f6bb00631055ec9b68a994f27bb5f5f5f76.css><script src=../js/meme.min.3a56ecbb4ec7b23a805fc0116d4dac9095813dfd877cd8379675a8bdac538ffe.js></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript><meta name=author content="Dev - jw"><meta name=description content="NFC_Protocol_Stack 几个方面 协议 NFCNDEFReaderSession —— 支持 NDEF 格式的标签 NFCTagReaderSession —— 支持 iso14443、iso15693、i……"><link rel="shortcut icon" href=../favicon.ico type=image/x-icon><link rel=mask-icon href=../icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=../icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Dev - jw"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Dev - jw"><meta name=msapplication-starturl content="../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../icons/mstile-150x150.png"><link rel=manifest href=../manifest.json><link rel=canonical href=https://dev.hjw.best/NFC/><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","datePublished":"2021-03-31T14:16:07+08:00","dateModified":"2021-03-31T15:42:56+08:00","url":"https://dev.hjw.best/NFC/","name":"iOS14下的NFC技术实践","description":"NFC_Protocol_Stack 几个方面 协议 NFCNDEFReaderSession —— 支持 NDEF 格式的标签 NFCTagReaderSession —— 支持 iso14443、iso15693、i……","image":"https://dev.hjw.best/favicon.ico","license":"Copyright","publisher":{"@type":"Organization","name":"Dev - jw","logo":{"@type":"ImageObject","url":"https://dev.hjw.best/favicon.ico"},"url":"https://dev.hjw.best/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://dev.hjw.best/"}}</script><meta name=twitter:card content="summary"><meta property="og:title" content="iOS14下的NFC技术实践"><meta property="og:description" content="NFC_Protocol_Stack 几个方面 协议 NFCNDEFReaderSession —— 支持 NDEF 格式的标签 NFCTagReaderSession —— 支持 iso14443、iso15693、i……"><meta property="og:url" content="https://dev.hjw.best/NFC/"><meta property="og:site_name" content="Dev - jw"><meta property="og:locale" content="zh"><meta property="og:image" content="https://dev.hjw.best/favicon.ico"><meta property="og:type" content="website"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lato:wght@700&text=reuixiy&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lato:wght@700&text=reuixiy&display=swap"></noscript><meta name=baidu-site-verification content="5nzYjT6RG7"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=../ class=brand>Dev - jw</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=../about><span class=menu-item-name>关于</span></a></li><li class=menu-item><a id=theme-switcher href=#><span class="icon theme-icon-light">🌞</span><span class="icon theme-icon-dark">🌙</span></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label><label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=default data-type=posts data-toc-num=true><h1 class="post-title p-name">iOS14下的NFC技术实践</h1><div class=post-meta><time datetime=2021-03-31T14:16:07+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2021-03-31</time></div><div class="post-body e-content"><h3 id=nfc_protocol_stack><a href=#nfc_protocol_stack class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>NFC_Protocol_Stack</h3><p><img src=https://w-md.imzsy.design/NFC_Protocol_Stack.png alt=NFC_Protocol_Stack></p><h3 id=几个方面><a href=#几个方面 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>几个方面</h3><ul><li>协议<ul><li><strong>NFCNDEFReaderSession</strong> —— 支持 NDEF 格式的标签</li><li><strong>NFCTagReaderSession</strong> —— 支持 iso14443、iso15693、iso18092<ul><li>iso14443，同时支持 A 和 B，兼容iso7816 和 miFare</li><li>iso15693，支持 iso15693</li><li>iso18092，支持 feliCa</li></ul></li></ul></li><li>优缺点<ul><li>优点：<ul><li>功耗低</li><li>连接速度快</li></ul></li><li>缺点：<ul><li>必须打开 App，唤起 NFC 扫描才能去识别内容，仅通过系统的识别，无法根据 NFC 标签中的内容去执行后续的操作</li><li>由于 NFC 标签不依赖于网络，外人轻易地获取 NFC 中的内容</li></ul></li></ul></li></ul><h3 id=ndef详解><a href=#ndef详解 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>NDEF详解</h3><p>NDEF 是一种能够在NFC设备或者标签之间进行信息交换的数据格式</p><p>分为两部分：</p><ul><li><p>NDEF Message：由负载记录数组组成的NDEF消息，对应为 <code>NFCNDEFMessage</code></p></li><li><p>NDEF Records：NDEF消息中的有效负载记录，对应为 <code>NFCNDEFPayload</code></p><p><strong>NFCNDEFPayload解释</strong></p><p>一条有效负载记录，用以下结构来标识内容和记录大小</p><p><img src=https://w-md.imzsy.design/image-20210323202233044.png alt=image-20210323202233044></p><h4 id=tnf-typenameformat-字段><a href=#tnf-typenameformat-字段 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>TNF: typeNameFormat 字段</h4><p>一条NDEF记录的类型名称是一个3个位的数值，用来描述这条记录的类型，并且可以用来设置对该记录中其它的结构和内容的期望</p><p>简单的说就是这3个位不仅可以表示该条记录的类型，也可以在一定程度上决定了该条记录接下来的数据结构。</p><p>可能的记录名称如下表：</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift> <span class=kd>public</span> <span class=kd>enum</span> <span class=nc>NFCTypeNameFormat</span> <span class=p>:</span> <span class=nb>UInt8</span> <span class=p>{</span>
   
     <span class=c1>/// 记录没有类型、id或有效payload，一般用于新格式化的 NDEF 卡上</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>empty</span> <span class=p>=</span> <span class=mi>0</span> 
     <span class=c1>/// Well-Known Record 表明记录类型字段使用RTD类型名称格式.这种类型名称用一个Record Type Definition (RTD)来存储任何指定的类型，例如：存储RTD文本、RTD URIs等等</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>nfcWellKnown</span> <span class=p>=</span> <span class=mi>1</span>
     <span class=c1>/// 表明payload是这条NDEF记录分块的中间或者最后一块</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>media</span> <span class=p>=</span> <span class=mi>2</span>
     <span class=c1>/// 表明这条记录的类型字段一定包含一个URI字段</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>absoluteURI</span> <span class=p>=</span> <span class=mi>3</span>
     <span class=c1>/// 表明这条记录的类型字段包含一个RTD格式的外部字段</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>nfcExternal</span> <span class=p>=</span> <span class=mi>4</span>
     <span class=c1>/// 表明payload的类型未知</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>unknown</span> <span class=p>=</span> <span class=mi>5</span>
     <span class=c1>/// 未发生变化的记录类型，释同MIME Media Record</span>
     <span class=p>@</span><span class=n>available</span><span class=p>(</span><span class=n>iOS</span> <span class=mf>11.0</span><span class=p>,</span> <span class=o>*</span><span class=p>)</span>
     <span class=k>case</span> <span class=n>unchanged</span> <span class=p>=</span> <span class=mi>6</span>
 <span class=p>}</span>
</code></pre></div><h3 id=ios-demo><a href=#ios-demo class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>iOS-Demo</h3><h4 id=基于-ndef-格式的读写><a href=#基于-ndef-格式的读写 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>基于 NDEF 格式的读写</h4><ul><li><p>初始化 <code>NFCNDEFReaderSession</code></p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift>   <span class=k>guard</span> <span class=n>NFCNDEFReaderSession</span><span class=p>.</span><span class=n>readingAvailable</span> <span class=k>else</span> <span class=p>{</span>
       <span class=n>completion</span><span class=p>?(.</span><span class=n>failure</span><span class=p>(</span><span class=n>NFCError</span><span class=p>.</span><span class=n>unavailable</span><span class=p>))</span>
       <span class=bp>print</span><span class=p>(</span><span class=s>&#34;NFC is not available on this device&#34;</span><span class=p>)</span>
       <span class=k>return</span>
   <span class=p>}</span>
     
   <span class=n>shared</span><span class=p>.</span><span class=n>session</span> <span class=p>=</span> <span class=n>NFCNDEFReaderSession</span><span class=p>(</span><span class=n>delegate</span><span class=p>:</span> <span class=n>shared</span><span class=p>.</span><span class=kc>self</span><span class=p>,</span> <span class=n>queue</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span> <span class=n>invalidateAfterFirstRead</span><span class=p>:</span> <span class=kc>false</span><span class=p>)</span>
   <span class=n>shared</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=n>action</span><span class=p>.</span><span class=n>alertMessage</span>
   <span class=n>shared</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>begin</span><span class=p>()</span>
</code></pre></div></li><li><p>实现<code>NFCNDEFReaderSessionDelegate</code>方法</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift>   <span class=kd>func</span> <span class=nf>readerSession</span><span class=p>(</span><span class=kc>_</span> <span class=n>session</span><span class=p>:</span> <span class=n>NFCNDEFReaderSession</span><span class=p>,</span> <span class=n>didInvalidateWithError</span> <span class=n>error</span><span class=p>:</span> <span class=n>Error</span><span class=p>)</span> <span class=p>{</span>
       <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=k>as</span><span class=p>?</span> <span class=n>NFCReaderError</span><span class=p>,</span>
          <span class=n>error</span><span class=p>.</span><span class=n>code</span> <span class=o>!=</span> <span class=p>.</span><span class=n>readerSessionInvalidationErrorFirstNDEFTagRead</span> <span class=o>&amp;&amp;</span>
           <span class=n>error</span><span class=p>.</span><span class=n>code</span> <span class=o>!=</span> <span class=p>.</span><span class=n>readerSessionInvalidationErrorUserCanceled</span> <span class=p>{</span>
           <span class=n>completion</span><span class=p>?(.</span><span class=n>failure</span><span class=p>(</span><span class=n>NFCError</span><span class=p>.</span><span class=n>invalidated</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>error</span><span class=p>.</span><span class=n>localizedDescription</span><span class=p>)))</span>
       <span class=p>}</span>
     
       <span class=kc>self</span><span class=p>.</span><span class=n>session</span> <span class=p>=</span> <span class=kc>nil</span>
       <span class=n>completion</span> <span class=p>=</span> <span class=kc>nil</span>
   <span class=p>}</span>
     
   <span class=kd>func</span> <span class=nf>readerSession</span><span class=p>(</span><span class=kc>_</span> <span class=n>session</span><span class=p>:</span> <span class=n>NFCNDEFReaderSession</span><span class=p>,</span> <span class=n>didDetect</span> <span class=n>tags</span><span class=p>:</span> <span class=p>[</span><span class=n>NFCNDEFTag</span><span class=p>])</span> <span class=p>{</span>
       <span class=k>guard</span> <span class=kd>let</span> <span class=nv>tag</span> <span class=p>=</span> <span class=n>tags</span><span class=p>.</span><span class=bp>first</span><span class=p>,</span> <span class=n>tags</span><span class=p>.</span><span class=bp>count</span> <span class=p>==</span> <span class=mi>1</span> <span class=k>else</span> <span class=p>{</span>
           <span class=n>session</span><span class=p>.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=s>&#34;There are too many tags present. Remove all and then try again.&#34;</span>
           <span class=n>DispatchQueue</span><span class=p>.</span><span class=n>global</span><span class=p>().</span><span class=n>asyncAfter</span><span class=p>(</span><span class=n>deadline</span><span class=p>:</span> <span class=p>.</span><span class=n>now</span><span class=p>()</span> <span class=o>+</span> <span class=p>.</span><span class=n>milliseconds</span><span class=p>(</span><span class=mi>500</span><span class=p>))</span> <span class=p>{</span>
               <span class=n>session</span><span class=p>.</span><span class=n>restartPolling</span><span class=p>()</span>
           <span class=p>}</span>
           <span class=k>return</span>
       <span class=p>}</span>
     
       <span class=n>session</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>to</span><span class=p>:</span> <span class=n>tag</span><span class=p>)</span> <span class=p>{</span> <span class=n>error</span> <span class=k>in</span>
           <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=p>{</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>handleError</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
               <span class=k>return</span>
           <span class=p>}</span>
     
           <span class=n>tag</span><span class=p>.</span><span class=n>queryNDEFStatus</span> <span class=p>{</span> <span class=p>(</span><span class=n>status</span><span class=p>,</span> <span class=kc>_</span><span class=p>,</span> <span class=n>error</span><span class=p>)</span> <span class=k>in</span>
               <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=p>{</span>
                   <span class=kc>self</span><span class=p>.</span><span class=n>handleError</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
                   <span class=k>return</span>
               <span class=p>}</span>
               <span class=c1>// Process Tag</span>
           <span class=p>}</span>
       <span class=p>}</span>
   <span class=p>}</span>
     
   <span class=kd>func</span> <span class=nf>readerSession</span><span class=p>(</span><span class=kc>_</span> <span class=n>session</span><span class=p>:</span> <span class=n>NFCNDEFReaderSession</span><span class=p>,</span> <span class=n>didDetectNDEFs</span> <span class=n>messages</span><span class=p>:</span> <span class=p>[</span><span class=n>NFCNDEFMessage</span><span class=p>])</span> <span class=p>{</span>
     
   <span class=p>}</span>
</code></pre></div></li><li><p>读取</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift>   <span class=kd>private</span> <span class=kd>func</span> <span class=nf>read</span><span class=p>(</span>
       <span class=n>tag</span><span class=p>:</span> <span class=n>NFCNDEFTag</span><span class=p>,</span>
       <span class=n>alertMessage</span><span class=p>:</span> <span class=nb>String</span> <span class=p>=</span> <span class=s>&#34;Tag Read&#34;</span><span class=p>,</span>
       <span class=n>readCompletion</span><span class=p>:</span> <span class=n>NFCReadingCompletion</span><span class=p>?</span> <span class=p>=</span> <span class=kc>nil</span>
   <span class=p>)</span> <span class=p>{</span>
       <span class=n>tag</span><span class=p>.</span><span class=n>readNDEF</span> <span class=p>{</span> <span class=n>message</span><span class=p>,</span> <span class=n>error</span> <span class=k>in</span>
           <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=p>{</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>handleError</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
               <span class=k>return</span>
           <span class=p>}</span>
     
           <span class=k>if</span> <span class=kd>let</span> <span class=nv>readCompletion</span> <span class=p>=</span> <span class=n>readCompletion</span><span class=p>,</span>
              <span class=kd>let</span> <span class=nv>message</span> <span class=p>=</span> <span class=n>message</span> <span class=p>{</span>
               <span class=n>readCompletion</span><span class=p>(.</span><span class=n>success</span><span class=p>(</span><span class=n>message</span><span class=p>))</span>
           <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=kd>let</span> <span class=nv>message</span> <span class=p>=</span> <span class=n>message</span><span class=p>,</span>
                     <span class=kd>let</span> <span class=nv>record</span> <span class=p>=</span> <span class=n>message</span><span class=p>.</span><span class=n>records</span><span class=p>.</span><span class=bp>first</span> <span class=p>{</span>
               <span class=kd>let</span> <span class=nv>payload</span> <span class=p>=</span> <span class=n>record</span><span class=p>.</span><span class=n>payload</span>
               <span class=n>printf</span><span class=p>(</span><span class=s>&#34;data: </span><span class=si>\(</span><span class=n>payload</span><span class=si>)</span><span class=s>&#34;</span><span class=p>)</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=s>&#34;Read tag data.&#34;</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>invalidate</span><span class=p>()</span>
           <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=s>&#34;Could not decode tag data.&#34;</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>invalidate</span><span class=p>()</span>
           <span class=p>}</span>
       <span class=p>}</span>
   <span class=p>}</span>
</code></pre></div></li><li><p>写入</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift>   <span class=kd>private</span> <span class=kd>func</span> <span class=nf>write</span><span class=p>(</span><span class=n>tag</span><span class=p>:</span> <span class=n>NFCNDEFTag</span><span class=p>)</span> <span class=p>{</span>
         
       <span class=kd>let</span> <span class=nv>payload</span> <span class=p>=</span> <span class=n>NFCNDEFPayload</span><span class=p>(</span><span class=n>format</span><span class=p>:</span> <span class=p>.</span><span class=n>nfcWellKnown</span><span class=p>,</span>
                                    <span class=n>type</span><span class=p>:</span> <span class=nb>String</span><span class=p>(</span><span class=s>&#34;U&#34;</span><span class=p>).</span><span class=n>data</span><span class=p>(</span><span class=n>using</span><span class=p>:</span> <span class=p>.</span><span class=n>utf8</span><span class=p>)</span><span class=o>!</span><span class=p>,</span>
                                    <span class=n>identifier</span><span class=p>:</span> <span class=nb>String</span><span class=p>(</span><span class=s>&#34;12345678&#34;</span><span class=p>).</span><span class=n>data</span><span class=p>(</span><span class=n>using</span><span class=p>:</span> <span class=p>.</span><span class=n>utf8</span><span class=p>)</span><span class=o>!</span><span class=p>,</span>
                                    <span class=n>payload</span><span class=p>:</span> <span class=nb>String</span><span class=p>(</span><span class=s>&#34;content&#34;</span><span class=p>).</span><span class=n>data</span><span class=p>(</span><span class=n>using</span><span class=p>:</span> <span class=p>.</span><span class=n>utf8</span><span class=p>)</span><span class=o>!</span><span class=p>)</span>
     
       <span class=kd>let</span> <span class=nv>NDEFMessage</span> <span class=p>=</span> <span class=n>NFCNDEFMessage</span><span class=p>(</span><span class=n>records</span><span class=p>:</span> <span class=p>[</span><span class=n>payload</span><span class=p>])</span>
       
       <span class=n>tag</span><span class=p>.</span><span class=n>writeNDEF</span><span class=p>(</span><span class=n>NDEFMessage</span><span class=p>)</span> <span class=p>{</span> <span class=n>error</span> <span class=k>in</span>
           <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=p>{</span>
               <span class=kc>self</span><span class=p>.</span><span class=n>handleError</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
               <span class=k>return</span>
           <span class=p>}</span>
           <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=s>&#34;Write Successed!&#34;</span>
           <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>invalidate</span><span class=p>()</span>
       <span class=p>}</span>
   <span class=p>}</span>
</code></pre></div></li></ul><blockquote><p>NDEF 使用的是 <strong>NDEFReadSession</strong>，而其他的标签格式，使用<strong>NFCTagReaderSession</strong></p></blockquote><h4 id=基于-iso14443-协议的读写><a href=#基于-iso14443-协议的读写 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>基于 iso14443 协议的读写</h4><p><code>iso14443</code>协议下，以下格式的标签会被发现</p><ul><li>Type A、Type B</li><li>MiFare</li><li>NFCISO7816</li></ul><h5 id=mifaretag指令交互><a href=#mifaretag指令交互 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>MifareTag指令交互</h5><p>在 iOS13 之后，对于 <code>MifareTag</code> 的标签，可以通过<code>sendMiFareCommand</code>或<code>sendMiFareISO7816Command</code>对标签的内存进行读写</p><p><strong>操作指令</strong></p><p>读：0x30</p><p>写：0xA2</p><p>验证：0x1B</p><p>示例：读取 D0 内存块的数据</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift> <span class=kd>let</span> <span class=nv>readBlockCommand</span><span class=p>:</span> <span class=nb>UInt8</span> <span class=p>=</span> <span class=mh>0x30</span>
   
 <span class=kd>let</span> <span class=nv>dataOffset</span><span class=p>:</span> <span class=nb>UInt8</span> <span class=p>=</span> <span class=mh>0xD0</span>
   
 <span class=kd>let</span> <span class=nv>readCommand</span> <span class=p>=</span> <span class=n>Data</span><span class=p>([</span><span class=n>readBlockCommand</span><span class=p>,</span> <span class=n>dataOffset</span><span class=p>])</span> 
   
 <span class=n>tag</span><span class=p>.</span><span class=n>sendMiFareCommand</span><span class=p>(</span><span class=n>commandPacket</span><span class=p>:</span> <span class=n>readCommand</span><span class=p>)</span> <span class=p>{</span> <span class=p>(</span><span class=n>response</span><span class=p>:</span> <span class=n>Data</span><span class=p>,</span> <span class=n>optionalError</span><span class=p>:</span> <span class=n>Error</span><span class=p>?)</span> <span class=k>in</span>
     <span class=k>guard</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>optionalError</span> <span class=k>else</span> <span class=p>{</span>
         <span class=n>completionHandler</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
         <span class=k>return</span>
     <span class=p>}</span>
   
     <span class=kc>self</span><span class=p>.</span><span class=n>readerSession</span><span class=p>?.</span><span class=n>invalidate</span><span class=p>(</span><span class=n>errorMessage</span><span class=p>:</span> <span class=s>&#34;Read tag error: </span><span class=si>\(</span><span class=n>error</span><span class=p>.</span><span class=n>localizedDescription</span><span class=si>)</span><span class=s>. Please try again.&#34;</span><span class=p>)</span>
 <span class=p>}</span>
</code></pre></div><blockquote><p>针对于受密码保护的标签，我们可以先通过验证指令，将密码发送给标签进行验证</p><p>当密码验证成功后，可以通过读写操作，访问内存块</p></blockquote><h4 id=唤醒-app><a href=#唤醒-app class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>唤醒 App</h4><p>原理：扫描 NFC 标签打开对应的 App 实际上是读取 NFC 标签数据区的 URL，然后打开该 URL 绑定的 App，类似 <strong>Universal Link</strong></p><p>数据格式为：</p><div class=table-container><table><thead><tr><th style=text-align:left>iOS 唤醒 NDEF</th><th style=text-align:left>示例</th><th style=text-align:left>描述</th></tr></thead><tbody><tr><td style=text-align:left>TNF</td><td style=text-align:left>0x01</td><td style=text-align:left>nfcWellKnown</td></tr><tr><td style=text-align:left>TYPE</td><td style=text-align:left>U</td><td style=text-align:left>RTD_URI</td></tr><tr><td style=text-align:left>ID</td><td style=text-align:left>NULL</td><td style=text-align:left>非必要不填减少存储占用</td></tr><tr><td style=text-align:left>PAYLOAD</td><td style=text-align:left>0x04 + 域名</td><td style=text-align:left>1字节url前缀「<a href=https://xn--26j/ target=_blank rel=noopener>https://」</a> + url内容数据</td></tr></tbody></table></div><p>这里以 NDEF 格式完成 Demo</p><p><strong>过程：</strong></p><ol><li><p>在关联的域名下添加<code>apple-app-site-association</code>文件，文件内容为：</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json> <span class=p>{</span>
     <span class=nt>&#34;applinks&#34;</span><span class=p>:</span> <span class=p>{</span>
         <span class=nt>&#34;apps&#34;</span><span class=p>:</span> <span class=p>[],</span>
         <span class=nt>&#34;details&#34;</span><span class=p>:</span> <span class=p>[</span>
             <span class=p>{</span>
                 <span class=nt>&#34;appID&#34;</span><span class=p>:</span> <span class=s2>&#34;DevelopmentTeamID.BundleID&#34;</span><span class=p>,</span>
                 <span class=nt>&#34;paths&#34;</span><span class=p>:</span> <span class=p>[</span> <span class=s2>&#34;*&#34;</span> <span class=p>]</span>
             <span class=p>}</span>
         <span class=p>]</span>
     <span class=p>}</span>
 <span class=p>}</span>
</code></pre></div><p><code>DevelopmentTeamID</code>可在Apple开发者中心的找到，<code>BundleID</code>为 App 的唯一标识</p><blockquote><p>如果 App 有对应的 App Clips，那么在<code>apple-app-site-association</code>文件可同时为其进行配置</p><p>如：</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json>  <span class=s2>&#34;appclips&#34;</span><span class=err>:</span> <span class=p>{</span>
      <span class=nt>&#34;apps&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;DevelopmentTeamID.BundleID&#34;</span><span class=p>]</span>
  <span class=p>}</span>
</code></pre></div></blockquote></li><li><p>选中相应的 Target，在<code>Signing & Capabilities</code> 选项卡，添加<code>Associated Domains</code>，填入对应的域名</p></li><li><p>添加回调方法，如果不存在 <code>SceneDelegate</code>，那么在 <code>AppDelegate</code> 中添加以下方法</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift> <span class=kd>func</span> <span class=nf>application</span><span class=p>(</span><span class=kc>_</span> <span class=n>application</span><span class=p>:</span> <span class=n>UIApplication</span><span class=p>,</span> <span class=k>continue</span> <span class=n>userActivity</span><span class=p>:</span> <span class=n>NSUserActivity</span><span class=p>,</span> <span class=n>restorationHandler</span><span class=p>:</span> <span class=p>@</span><span class=n>escaping</span> <span class=p>([</span><span class=n>UIUserActivityRestoring</span><span class=p>]?)</span> <span class=p>-&gt;</span> <span class=nb>Void</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=nb>Bool</span> <span class=p>{</span>
     <span class=k>guard</span> <span class=n>userActivity</span><span class=p>.</span><span class=n>activityType</span> <span class=p>==</span> <span class=n>NSUserActivityTypeBrowsingWeb</span> <span class=k>else</span> <span class=p>{</span>
         <span class=k>return</span> <span class=kc>false</span>
     <span class=p>}</span>
      
     <span class=c1>// Confirm that the NSUserActivity object contains a valid NDEF message.</span>
     <span class=kd>let</span> <span class=nv>ndefMessage</span> <span class=p>=</span> <span class=n>userActivity</span><span class=p>.</span><span class=n>ndefMessagePayload</span>
     <span class=k>guard</span> <span class=n>ndefMessage</span><span class=p>.</span><span class=n>records</span><span class=p>.</span><span class=bp>count</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span>
         <span class=n>ndefMessage</span><span class=p>.</span><span class=n>records</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>typeNameFormat</span> <span class=o>!=</span> <span class=p>.</span><span class=n>empty</span> <span class=k>else</span> <span class=p>{</span>
             <span class=k>return</span> <span class=kc>false</span>
     <span class=p>}</span>
      
     <span class=c1>// Send the message to `XXXX` for processing.</span>
     <span class=bp>print</span><span class=p>(</span><span class=n>ndefMessage</span><span class=p>)</span>
      
     <span class=k>return</span> <span class=kc>true</span>
 <span class=p>}</span>
</code></pre></div><p>如果使用 <code>SceneDelegate</code>，那么需要实现<code>func scene(_ scene: UIScene, continue userActivity: NSUserActivity)</code>方法</p></li><li><p>创建 URL 的 NFC 标签，这里以 NDEF 格式为例</p><div class=highlight><pre class=chroma><code class=language-swift data-lang=swift> <span class=kd>private</span> <span class=kd>func</span> <span class=nf>write</span><span class=p>(</span><span class=n>tag</span><span class=p>:</span> <span class=n>NFCNDEFTag</span><span class=p>)</span> <span class=p>{</span>
      
     <span class=kd>let</span> <span class=nv>backgroudPayLoad</span> <span class=p>=</span> <span class=n>NFCNDEFPayload</span><span class=p>.</span><span class=n>wellKnownTypeURIPayload</span><span class=p>(</span><span class=n>string</span><span class=p>:</span> <span class=nb>String</span><span class=p>(</span><span class=s>&#34;域名&#34;</span><span class=p>))</span>
      
     <span class=kd>let</span> <span class=nv>NDEFMessage</span> <span class=p>=</span> <span class=n>NFCNDEFMessage</span><span class=p>(</span><span class=n>records</span><span class=p>:</span> <span class=p>[</span><span class=n>backgroudPayLoad</span><span class=p>!])</span>
      
     <span class=n>tag</span> <span class=p>.</span><span class=n>writeNDEF</span><span class=p>(</span><span class=n>NDEFMessage</span><span class=p>)</span> <span class=p>{</span> <span class=n>error</span> <span class=k>in</span>
         <span class=k>if</span> <span class=kd>let</span> <span class=nv>error</span> <span class=p>=</span> <span class=n>error</span> <span class=p>{</span>
             <span class=kc>self</span><span class=p>.</span><span class=n>handleError</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
             <span class=k>return</span>
         <span class=p>}</span>
         <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>alertMessage</span> <span class=p>=</span> <span class=s>&#34;Write Successed!&#34;</span>
         <span class=kc>self</span><span class=p>.</span><span class=n>session</span><span class=p>?.</span><span class=n>invalidate</span><span class=p>()</span>
     <span class=p>}</span>
 <span class=p>}</span>
</code></pre></div></li></ol><h5 id=测试效果><a href=#测试效果 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>测试效果</h5><p>现在，载有 URL 的 NFC 标签已经准备好了，并且对应 URL 的 App 也已经准备完毕，可以进行测试</p><p><img src=https://w-md.imzsy.design/image-20210304150620691.png alt=image-20210304150620691></p><p>当我们的 App 没有被启动，或在前台时，手机识别到 NFC 信息</p><ol><li>首先，会显示通知</li><li>点击通知，会打开相应的 App</li><li>在回调中，可以看到内容被输出</li></ol><h3 id=注意点><a href=#注意点 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>注意点</h3><h4 id=支持系统扫描的标签><a href=#支持系统扫描的标签 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>支持系统扫描的标签</h4><p>设备在后台标签读取模式下扫描NFC标签后，系统将通过查找具有以下属性值的<code>NFCNDEFPayLoad</code>对象来检查标签的NDEF消息中的URI记录：</p><ul><li><p><code>ypeNameFormat</code>等于<code>NFCTypeNameFormatNFCWellKnown</code></p></li><li><p><code>type</code>等于<strong>U</strong></p><p>如果NDEF消息包含多个URI记录，系统将使用第一个记录。</p><p>URI记录必须包含通用链接或支持的URL方案。</p><h4 id=url-schemes><a href=#url-schemes class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>URL Schemes</h4><p>根据官方文档，我们并不能使用 <code>Custom URL Scheme</code>，而只支持以下的 <code>URL Schems</code></p><div class=table-container><table><thead><tr><th style=text-align:left>URL Scheme</th><th style=text-align:left>Example</th></tr></thead><tbody><tr><td style=text-align:left>Website URL (HTTP/HTTPS)</td><td style=text-align:left><a href=https://www.example.com target=_blank rel=noopener>https://www.example.com</a></td></tr><tr><td style=text-align:left>Email</td><td style=text-align:left><a href=mailto:mailto:user@example.com>mailto:user@example.com</a></td></tr><tr><td style=text-align:left>SMS</td><td style=text-align:left>sms:+14085551212</td></tr><tr><td style=text-align:left>Telephone</td><td style=text-align:left>tel:+14085551212</td></tr><tr><td style=text-align:left>FaceTime</td><td style=text-align:left>facetime://<a href=mailto:user@example.com>user@example.com</a></td></tr><tr><td style=text-align:left>FaceTime Audio</td><td style=text-align:left>facetime-audio://<a href=mailto:user@example.com>user@example.com</a></td></tr><tr><td style=text-align:left>Maps</td><td style=text-align:left>[http://maps.apple.com/?address=Apple%20Park,Cupertino,California](<a href="http://maps.apple.com/?address=Apple" target=_blank rel=noopener>http://maps.apple.com/?address=Apple</a> Park,Cupertino,California)</td></tr><tr><td style=text-align:left>HomeKit Accessory Setup</td><td style=text-align:left>X-HM://12345</td></tr></tbody></table></div><h3 id=其他><a href=#其他 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>其他</h3><blockquote><ol><li>苹果手机从iPhone6开始装有NFC硬件，但并未对第三方应用开放。因此iPhone6及iPhone6s不能识别NFC标签，但是可以使用系统NFC功能如：刷地铁。</li><li>苹果从iOS11系统开始开放NFC读取功能，同时要求iPhone7及以上机型。不满足要求则无法读取NFC标签</li><li>苹果在iOS13系统开放了标签写入功能，想要向标签内写入数据，需要升级系统到iOS13，同样只能写入DNEF格式数据</li><li>另外苹果只开放DNEF数据格式的NFC标签读取，如果数据格式不满足则无法读取。身份证、地铁卡、银行卡、大部分的工卡都不是DNEF格式，因此无法读取。（空标签只能在iOS13系统下才可以读取到）（NFC标签可以去淘宝购买，价格很便宜 9.9六个还包邮）</li><li>身份证、地铁卡虽然无法读取到数据，但是可以用苹果官方APP“快捷指令”进行标记，来实现一些新颖玩法（需要iPhoneXS以上机型）</li><li>关于后台读取，iPhoneXS以上机型支持，屏幕点亮状态下（无需解锁），手机可以读取一些特定数据格式的NFC标签。识别到标签后，可以实现拨打电话，发送邮件等功能（需解锁）</li></ol></blockquote><h3 id=参考资料><a href=#参考资料 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>参考资料：</h3><p><a href=https://developer.apple.com/documentation/corenfc target=_blank rel=noopener>CoreNFC</a></p><p><a href=https://www.bluebite.com/nfc/iphone-nfc-compatibility target=_blank rel=noopener>iPhone NFC Compatibility</a></p></li></ul></li></ul></div></article><div class=post-tags><a href=../tags/ios/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>iOS</a>
<a href=../tags/nfc/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>NFC</a></div></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>©&nbsp;2019–2021&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;Dev - jw</div></div></footer></div><script>'serviceWorker'in navigator&&window.addEventListener('load',function(){navigator.serviceWorker.register('/sw.js')})</script><script>typeof MathJax=='undefined'?(window.MathJax={loader:{load:['[tex]/mhchem']},options:{renderActions:{addMenu:[0,'','']}},tex:{inlineMath:{'[+]':[['$','$']]},tags:'ams',packages:{'[+]':['mhchem']}}},function(){var a=document.createElement('script');a.src='https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js',a.defer=!0,document.head.appendChild(a)}()):(MathJax.texReset(),MathJax.typeset())</script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js></script><script>let mermaidConfig={startOnLoad:!0,flowchart:{useMaxWidth:!1,htmlLabels:!0},theme:'default'};mermaid.initialize(mermaidConfig)</script><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script><script>mediumZoom(document.querySelectorAll('div.post-body img'),{background:'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script></body></html>